---
title: "Problemas_ResueltosGrupo1"
author: "PAULA FERNÁNEZ MACÍAS (78137222N)"
date: "2024-10-10"
output: html_document
---
## PROBLEMAS RESUELTOS / TEORÍA DE LA DECISIÓN / GRUPO 1

#PAULA FERNÁNDEZ MACÍAS

PROBLEMA 1
Una empresa está considerando invertir en tres posibles proyectos: 
Proyecto A, Proyecto B y Proyecto C. 
La empresa no sabe cuál de tres posibles estados del mercado ocurrirá: Estado 1, Estado 2 o Estado 3. Cada estado tiene diferentes rendimientos (ganancias o pérdidas) asociados con los proyectos, pero no se conoce la probabilidad de que ocurran estos estados.

La siguiente tabla de decisión resume las ganancias o pérdidas estimadas (en miles de dólares) de cada proyecto en cada uno de los estados del mercado:

```{r}
source("teoriadecision_funciones_incertidumbre.R")
tb1 = crea.tablaX(c(100, 150, -50,
                  80, 200, 100,
                  50, -100, 250), numalternativas = 3, numestados = 3)
```

CASO FAVORABLE:
```{r}
#WALD:
s01_wald = criterio.Wald(tb1, T)
s01_wald     
names(s01_wald$AlternativaOptima) 
```
la mejor opción es el proyecto B, ya que elegimos el maximo
```{r}
#CRITERIO OPTIMISTA:
s01_opt = criterio.Optimista(tb1, T)
s01_opt
s01_opt$ValorAlternativas
s01_opt$AlternativaOptima    
```
En este caso, el proyecto elegido sería el C
```{r}
#HURWICZ:
s01_hurwicz = criterio.Hurwicz(tb1, alfa = 0.5, T)
s01_hurwicz
s01_hurwicz$ValorAlternativas
s01_hurwicz$AlternativaOptima     
```
Sale ganador el proyecto B
```{r}
#LAPLACE:
s01_lp = criterio.Laplace(tb1, T)
s01_lp
s01_lp$AlternativaOptima    
```
Proyecto B, la mejor decisión
```{r}
#PUNTO IDEAL:
s01_pi = criterio.PuntoIdeal(tb1, T)
s01_pi$ValorAlternativas
s01_pi$AlternativaOptima      
```
Proyecto B
```{r}
#SAVAGE:
s01_savage = criterio.Savage(tb1, T)
s01_savage
s01_savage$ValorAlternativas
s01_savage$AlternativaOptima
```
El PROYECTO B es la mejor opción menos en el criterio optimista,
por tanto, podríamos decir que el PROYECTO B es la mejor decisión en condiciones de incertidumbre,
en el caso FAVORABLE.
Vamos a utilizar la representación gráfica de uno de los modelos vistos, el modelo de Hurwicz:
```{r}
dibuja.criterio.Hurwicz(tb1, T)
```

CASO DESFAVORABLE:
```{r}
#WALD:
s01_waldF = criterio.Wald(tb1, F)
s01_waldF   
names(s01_waldF$AlternativaOptima)
```
La mejor opción es el proyecto A, ya que elegimos el mínimo.
```{r}
#CRITERIO OPTIMISTA:
s01_optF = criterio.Optimista(tb1, F)
s01_optF
s01_optF$ValorAlternativas
s01_optF$AlternativaOptima   
```
En este caso, el proyecto elegido sería el C
```{r}
#HURWICZ:
s01_hurwiczF = criterio.Hurwicz(tb1, alfa = 0.5, F)
s01_hurwiczF
s01_hurwiczF$ValorAlternativas
s01_hurwiczF$AlternativaOptima     
```
Sale ganador el proyecto A
```{r}
#LAPLACE:
s01_lpF = criterio.Laplace(tb1, F)
s01_lpF
s01_lpF$AlternativaOptima    
```
Proyecto A ó el Proyecto C, nos encontramos ante un empate de decisión
```{r}
#PUNTO IDEAL:
s01_piF = criterio.PuntoIdeal(tb1, F)
s01_piF$ValorAlternativas
s01_piF$AlternativaOptima   
```
Proyecto A
```{r}
#SAVAGE:
s01_savageF = criterio.Savage(tb1, F)
s01_savageF
s01_savageF$ValorAlternativas
s01_savageF$AlternativaOptima     
```
Proyecto A

En el caso DESFAVORABLE, elegir el Proyecto A es la mejor decisión, 
aunque en el caso óptimo y en LaPlace nos indiquen como mejor ópción el proyecto C.


PROBLEMA 2
Una empresa de software ha desarrollado un nuevo programa y tiene dos opciones para lanzarlo al mercado:

1. Vender los derechos del software a una gran empresa tecnológica por un pago fijo de 50,000 euros.
2. Lanzar el software por su cuenta, incurriendo en un coste inicial de 120,000 euros por desarrollo y marketing, pero ganando 5 euros por cada unidad vendida.

La empresa no está segura de cómo reaccionará el mercado y tiene dos posibles escenarios:
- Éxito en ventas: Se venderán 40,000 unidades del software.
- Fracaso en ventas: Solo se venderán 10,000 unidades.
La empresa quiere tomar una decisión entre vender los derechos o lanzar el software por su cuenta, pero no sabe qué escenario del mercado ocurrirá.

¿Debe la empresa aceptar la oferta de vender los derechos del software o lanzarlo por su cuenta?
```{r}
#OPCIÓN 1:    #la ganancia es fija por lo tanto, 50000 euros
#OPCIÓN 2:
Exito = 40000*5 - 120000    #euros
Fracaso  = 10000*5 - 120000     #euros
#TABLA DE DECISIÓN:
tb2 = crea.tablaX(c(50000, 50000,
                    Exito, Fracaso), 2, 2)
rownames(tb2) = c("Vender derechos", "Lanzar por su cuenta")
#aplicamos criterios de incertidumbre:
sol2 = criterio.Todos(tb2, 0.5, T)
sol2
```
Vamos a  ver gráficamente:  (criterio Hurwicz)
```{r}
dibuja.criterio.Hurwicz(tb2)
```
La mejor opción es VENDER los derechos del software.
Esta opción es la favorable en todos los criterios menos en el criterio óptimo; 
ya que ofrece seguridad y evita pérdidas potenciales en caso de fracaso en ventas.


# FEDERICA RUBINO

```{r}
## Primer Problema: Decisión de Expansión para una Empresa de Alimentos

source("teoriadecision_funciones_incertidumbre.R")

# Crear la tabla de decisión con los datos del problema
tb4 = crea.tablaX(c(150000, 300000, 100000,  # Proyecto A
                    100000, 200000, 250000,  # Proyecto B
                    -50000, 80000, -100000), # Proyecto C
                  numalternativas = 3, numestados = 3)

# Mostrar la tabla de decisión
print("Tabla de Decisión para la Empresa de Tecnología:")
tb4


```
Evaluación por Métodos de Decisión (Situaciones Favorables y Desfavorables)


Criterio de Wald (Pesimista):

```{r}
## Situación Favorable:
  
wald_result_favorable = criterio.Wald(tb1, favorable = TRUE)
print("Resultado según el Criterio de Wald (Favorable):")
wald_result_favorable$AlternativaOptima

```

```{r}
## Situación Desfavorable:

wald_result_desfavorable = criterio.Wald(tb1, favorable = FALSE)
print("Resultado según el Criterio de Wald (Desfavorable):")
wald_result_desfavorable$AlternativaOptima
```

Criterio Optimista:

```{r}
## Situación Favorable:

opt_result_favorable = criterio.Optimista(tb1, favorable = TRUE)
print("Resultado según el Criterio Optimista (Favorable):")
opt_result_favorable$AlternativaOptima
```

```{r}
## Situación Desfavorable:

opt_result_desfavorable = criterio.Optimista(tb1, favorable = FALSE)
print("Resultado según el Criterio Optimista (Desfavorable):")
opt_result_desfavorable$AlternativaOptima
```

Criterio de Hurwicz (Ponderación 60%)
Usamos un coeficiente alfa de 0.7.

```{r}
## Situación Favorable:

hurwicz_result_favorable = criterio.Hurwicz(tb1, alfa = 0.7, favorable = TRUE)
print("Resultado según el Criterio de Hurwicz (Favorable):")
hurwicz_result_favorable$AlternativaOptima
```

```{r}
## Situación Desfavorable:

hurwicz_result_desfavorable = criterio.Hurwicz(tb1, alfa = 0.7, favorable = FALSE)
print("Resultado según el Criterio de Hurwicz (Desfavorable):")
hurwicz_result_desfavorable$AlternativaOptima
```

Criterio de Laplace:

```{r}
## Situación Favorable:

laplace_result_favorable = criterio.Laplace(tb1, favorable = TRUE)
print("Resultado según el Criterio de Laplace (Favorable):")
laplace_result_favorable$AlternativaOptima
```

```{r}
## Situación Desfavorable:

laplace_result_desfavorable = criterio.Laplace(tb1, favorable = FALSE)
print("Resultado según el Criterio de Laplace (Desfavorable):")
laplace_result_desfavorable$AlternativaOptima
```

Criterio de Savage (Minimización del Arrepentimiento)

```{r}
## Situación Favorable:

savage_result_favorable = criterio.Savage(tb1, favorable = TRUE)
print("Resultado según el Criterio de Savage (Favorable):")
savage_result_favorable$AlternativaOptima
```

```{r}
##Situación Desfavorable:

savage_result_desfavorable = criterio.Savage(tb1, favorable = FALSE)
print("Resultado según el Criterio de Savage (Desfavorable):")
savage_result_desfavorable$AlternativaOptima
```

Frente a lo que se desprende de cada método utilizado, la opción A es la mejor para cada uno de ellos en el caso de una situación favorable, mientras que en el caso de una situación desfavorable la mejor opción es la C.



Problema 2: escenario real. 

Vamos a calcular las ganancias netas restando las inversiones de los ingresos esperados en cada escenario:

Para la Opción A (ropa básica):
Escenario Favorable: 50,000 - 10,000 = 40,000 euros
Escenario Desfavorable: 15,000 - 10,000 = 5,000 euros
Para la Opción B (ropa premium):
Escenario Favorable: 50,000 - 30,000 = 20,000 euros
Escenario Desfavorable: 15,000 - 30,000 = -15,000 euros

Creamos una tabla de decisión basada en los escenarios planteados:

```{r}
tb4 = crea.tablaX(c(40000, 5000,    # Opción A
                    20000, -15000),  # Opción B
                  numalternativas = 2, numestados = 2)

# Mostrar la tabla de decisión
print("Tabla de Decisión para la Tienda de Ropa:")
tb4


```

```{r}
# Aplicar todos los métodos a la tabla de decisión
resultados_tb4 = criterio.Todos(tb4, alfa = 0.5, favorable = TRUE)

# Mostrar los resultados
print("Resultados aplicando todos los criterios:")
resultados_tb4

# Graficamente: dibuja el criterio Hurwicz
dibuja.criterio.Hurwicz(tb4)

```

La mejor opción es la A (d1) por todos los criterios (ropa básica), ya que es más estable en el escenario desfavorable y proporciona una mayor ganancia en el escenario favorable. Asegura un beneficio en ambas situaciones que puedan surgir..
 

# MARIO JIMÉNEZ LEÓN 
# Poblema 1
&nbsp;&nbsp;&nbsp;&nbsp;Aplicar los criterios de decisión bajo incertidumbre al problema cuya matriz de valores numéricos viene dada por la siguiente tabla:

$$
\begin{array}{|c|c|c|c|c|}
\hline
    & e1 & e2 & e3 & e4 \\
\hline
d1  & 5  & 3  & 2  & 8  \\
\hline
d2  & 1  & 7  & 4  & 1  \\
\hline
d3  & 2  & 4  & 6  & 6  \\
\hline
\end{array}
$$


```{r}
source("teoriadecision_funciones_incertidumbre.R")

tablaX = matrix(c(5,3,2,8,
                  1,7,4,1,
                  2,4,6,6),nrow=3,ncol=4,byrow=TRUE)
colnames(tablaX)=c('e1','e2','e3','e4')
rownames(tablaX)=c('d1','d2','d3')
tablaX
```


## Situación favorable:

#### Criterio de Wald o Pesimista
```{r}
criterio.Wald(tablaX,favorable=TRUE) 
```
Para este criterio, la opción óptima es cualquiera de las alternativas **d1** o **d3**

#### Criterio Optimista
```{r}
criterio.Optimista(tablaX,favorable=TRUE)
```
Para este criterio, la mejor alternativa es **d1**

#### Criterio Hurwicz
```{r}
criterio.Hurwicz(tablaX,alfa=0.3,favorable=TRUE)
```
Para este criterio, la mejor alternativa es **d1**

#### Savage
```{r}
criterio.Savage(tablaX,favorable=TRUE)
```
Para este criterio, la mejor alternativa es **d3**

#### Criterio Laplace
```{r}
criterio.Laplace(tablaX,favorable=TRUE)
```
Para este criterio, la mejor alternativa es cualquiera de **d1** o **d3**

#### Criterio punto ideal
```{r}
criterio.PuntoIdeal(tablaX,favorable=TRUE)
```
Para este criterio, la mejor alternativa es **d3**


## Situación desfavorable:

#### Criterio de Wald o Pesimista
```{r}
criterio.Wald(tablaX,favorable=FALSE) 
```
Para este criterio, la mejor alternativa es **d3**

#### Criterio Optimista
```{r}
criterio.Optimista(tablaX,favorable=FALSE)
```
Para este criterio, la mejor alternativa es **d2**

#### Criterio Hurwicz
```{r}
criterio.Hurwicz(tablaX,alfa=0.3,favorable=FALSE)
```
Para este criterio, la mejor alternativa es **d3**

#### Savage
```{r}
criterio.Savage(tablaX,favorable=FALSE)
```
Para este criterio, la mejor alternativa es **d2**

#### Criterio Laplace
```{r}
criterio.Laplace(tablaX,favorable=FALSE)
```
Para este criterio, la mejor alternativa es **d2**

#### Criterio punto ideal
```{r}
criterio.PuntoIdeal(tablaX,favorable=FALSE)
```
Para este criterio, la mejor alternativa es **d2**


# Problema 2
Clara y Pedro están considerando cambiar su plan de telefonía móvil y se enfrentan a tres opciones de tarifas ofrecidas por la misma compañía. Sin embargo, no están seguros de cuál es la mejor opción, ya que la decisión puede variar mucho de mes a mes, lo que introduce incertidumbre en la decisión.

Las tarifas disponibles son las siguientes:

- Tarifa Básica:
Precio: 10 euros al mes.
Datos incluidos: 2 GB de internet.
Costo adicional por cada GB extra: 5 euros por GB.

- Tarifa Media:
Precio: 20 euros al mes.
Datos incluidos: 10 GB de internet.
Costo adicional por cada GB extra: 3 euros por GB.

- Tarifa Ilimitada:
Precio: 35 euros al mes.
Datos incluidos: Datos ilimitados (sin cargos adicionales por uso extra).

Uso mensual esperado: Clara y Pedro no están seguros de cuántos datos usarán al mes, pero consideran los siguientes escenarios posibles basados en su historial de uso:
- Escenario bajo: Usarán 5 GB en total.
- Escenario moderado: Usarán 15 GB en total.
- Escenario alto: Usarán 25 GB en total.

$$
\begin{array}{|c|c|c|c|}
\hline
\textbf{} & \textbf{Bajo\ (5GB)} & \textbf{Moderado\ (15GB)} & \textbf{Alto\ (25GB)} \\
\hline
\text{Básica}    & 25  & 75  & 125 \\
\hline
\text{Media}     & 20  & 35  & 65  \\
\hline
\text{Ilimitada} & 35  & 35  & 35  \\
\hline
\end{array}
$$

## Resolución del problema:

```{r}
tablaY = matrix(c(25,75,125,
                  20,35,65,
                  35,35,35),nrow=3,ncol=3,byrow=TRUE)
colnames(tablaY)=c('Bajo','Moderado','Alto')
rownames(tablaY)=c('Basica','Media','Ilimitada')
tablaY
```


#### Resumen de los criterios
```{r}
criterio.Todos(tablaY,alfa=0.3,favorable=F)
```

La solución óptima para cada criterio aparece en la última fila de la tabla resultante

# ALICIA CANTERO DÍAZ 

#PROBLEMA 1 
#Tabla de decisión 
```{r}
pagos_problema1 <- matrix(c(500, -100, 300, 50, 100, 100), 
                          nrow = 3, byrow = TRUE,
                          dimnames = list(c("Expandirse agresivamente", 
                                            "Expandirse moderadamente", 
                                            "No expandirse"),
                                          c("Mercado Favorable", 
                                            "Mercado Desfavorable")))
pagos_problema1
```
## Situación favorable
# Criterio de Wald o Pesimista 
```{r}
criterio.Wald(pagos_problema1,favorable=TRUE) 
```
Para este criterio, la mejor alternativa es No expandirse
# Criterio Optimista
```{r}
criterio.Optimista(pagos_problema1,favorable=TRUE)
```
Para este criterio, la mejor alternativa es Expandirse agresivamente
# Criterio Hurwicz
```{r}
criterio.Hurwicz(pagos_problema1,alfa=0.3,favorable=TRUE)
```
Para este criterio, la mejor alternativa es Expandirse moderadamente
# Savage
```{r}
criterio.Savage(pagos_problema1,favorable=TRUE)
```
Para este criterio, la mejor alternativa es Expandirse agresivamente o Expandirse moderadamente 
# Criterio Laplace
```{r}
criterio.Laplace(pagos_problema1,favorable=TRUE)
```
Para este criterio, la mejor alternativa es Expandirse agresivamente
# Criterio punto ideal
```{r}
criterio.PuntoIdeal(pagos_problema1,favorable=TRUE)
```
Para este criterio, la mejor alternativa es Expandirse agresivamente 
#conclusion 
En la situación favorable practicamente cada criterio da una mejor alternativa con lo cual a la hora de elegir dependerá de qué tipo de decisión quieras priorizar. 
## Situación desfavorable:
# Criterio de Wald o Pesimista
```{r}
criterio.Wald(pagos_problema1,favorable=FALSE) 
```
Para este criterio, la mejor alternativa es No expandirse 
# Criterio Optimista
```{r}
criterio.Optimista(pagos_problema1,favorable=FALSE)
```
Para este criterio, la mejor alternativa es Expandirse agresivamente
# Criterio Hurwicz
```{r}
criterio.Hurwicz(pagos_problema1,alfa=0.3,favorable=FALSE)
```
Para este criterio, la mejor alternativa es No expandirse 
# Savage
```{r}
criterio.Savage(pagos_problema1,favorable=FALSE)
```
Para este criterio, la mejor alternativa es Expandirse moderadamente o No expandirse
# Criterio Laplace
```{r}
criterio.Laplace(pagos_problema1,favorable=FALSE)
```
Para este criterio, la mejor alternativa es No expandirse 
# Criterio punto ideal
```{r}
criterio.PuntoIdeal(pagos_problema1,favorable=FALSE)
```
Para este criterio, la mejor alternativa es No expandirse
#conclusión 
En la situación desfavorable, la mejor alternativa es No expandirse ya que practicamente todos los criterios coinciden. 

#PROBLEMA 2 
#Tabla 
```{r}
pagos_problema2 <- matrix(c(200, 50, 150, 80, 0, 0), 
                          nrow = 3, byrow = TRUE,
                          dimnames = list(c("Cultivar trigo", 
                                            "Cultivar maíz", 
                                            "No cultivar"),
                                          c("Lluvias Abundantes", 
                                            "Sequía")))
pagos_problema2
```
```{r}
criterio.Todos(pagos_problema2,alfa=0.3,favorable=F)
```
#Conclusión 
La elección entre cultivar trigo y maíz depende de la tolerancia al riesgo del agricultor y las expectativas sobre las condiciones climáticas. Si el agricultor se inclina por un enfoque más conservador, podría optar por no cultivar o cultivar maíz. Sin embargo, si está dispuesto a asumir un mayor riesgo para obtener mayores beneficios, cultivar trigo sería la mejor opción, especialmente en un escenario de lluvias abundantes.



# PABLO GONZÁLEZ GÓMEZ

## Problema 1

Aplicar los criterios de decisión bajo incertidumbre al problema cuya matriz de valores numéricos viene dada en la tabla siguiente:

|        | e1  | e2  | e3  |
|--------|-----|-----|-----|
| **d1** | 150 | 90  | 30  |
| **d2** | 200 | 80  | 10  |
| **d3** | 250 | 100 | -50 |

```{r}
source("teoriadecision_funciones_incertidumbre.R")
tb1 = crea.tablaX(c(150,90,30,
                  200,80,10,
                  250,100,-50), numalternativas=3, numestados=3)
tb1

```

### SITUACIÓN FAVORABLE

#### Criterio de Wald o pesimista

```{r}
(fav_wald=criterio.Wald(tb1,T))
```

La alternativa óptima es **d1**

#### Criterio optimista

```{r}
(fav_opt=criterio.Optimista(tb1,T))
```

La alternativa óptima es **d3**

#### Criterio de Hurwicz (alfa=0.5)

```{r}
(fav_hur=criterio.Hurwicz(tb1,alfa = 0.5,T))
```

La alternativa óptima es **d2**

#### Criterio de Savage

```{r}
(fav_sav=criterio.Savage(tb1,T))
```

La alternativa óptima es **d2**

#### Criterio de Laplace

```{r}
(fav_lap=criterio.Laplace(tb1,T))
```

La alternativa óptima es **d3**

#### Criterio punto ideal

```{r}
(fav_pi=criterio.PuntoIdeal(tb1,T))
```

La alternativa óptima es **d2**

### SITUACIÓN DESFAVORABLE

#### Criterio de Wald o pesimista

```{r}
(des_wald=criterio.Wald(tb1,F))
```

La alternativa óptima es **d1**

#### Criterio optimista

```{r}
(des_opt=criterio.Optimista(tb1,F))
```

La alternativa óptima es **d3**

#### Criterio de Hurwicz (alfa=0.5)

```{r}
(des_hur=criterio.Hurwicz(tb1,alfa = 0.5,F))
```

La alternativa óptima es **d1**

#### Criterio de Savage

```{r}
(des_sav=criterio.Savage(tb1,F))
```

La alternativa óptima es **d2**

#### Criterio de Laplace

```{r}
(des_lap=criterio.Laplace(tb1,F))
```

La alternativa óptima es **d1**

#### Criterio punto ideal

```{r}
(des_pi=criterio.PuntoIdeal(tb1,F))
```

La alternativa óptima es **d2**

## Problema 2

Un gerente de ventas debe decidir qué producto lanzar en el próximo trimestre, pero no sabe cómo se comportará el mercado. Tiene tres opciones de producto: producto A, producto B y producto C. Los escenarios de mercado posibles son: alta demanda, demanda moderada y baja demanda. Dependiendo del comportamiento del mercado, los beneficios de cada producto varían.

La siguiente tabla muestra las ganancias esperadas (en miles de euros) en cada escenario de demanda:

|                | Alta demanda | Demanda moderada | Baja demanda |
|----------------|--------------|------------------|--------------|
| **Producto A** | 50           | 30               | -10          |
| **Producto B** | 40           | 35               | 5            |
| **Producto C** | 60           | 20               | -20          |

Si el gerente quiere minimizar pérdidas en caso de fracaso en las ventas, ¿qué producto le recomendaría que lanzase al mercado?

```{r}
tb2 = crea.tablaX(c(50,30,-10,
                    40,35,5,
                    60,20,-20), 3, 3)
rownames(tb2)=c("Producto 1", "Producto 2", "Producto 3")
colnames(tb2)=c("Alta demanda", "Demanda moderada","Baja demanda")
tb2
```

```{r}
(sol2=criterio.Todos(tb2, 0.5, T))
```

La mejor opción sería lanzar al mercado el producto 2, pues es la alternativa óptima en 3 de los 6 criteriors (Wald, Hurwicz y Laplace), lo que nos indica que en caso de que las ventas no sean un éxito, seguiría habiendo beneficio aunque sea algo escaso. Además es el producto que da un mayor beneficio en caso de que la demanda no sea ni alta ni baja, por lo que es un producto que ofrece una gran seguridad.
